name: trigger_deploy
on:
  pull_request:
jobs:
  notify_infrastructure_repo:
    runs-on: ubuntu-latest
    steps:
      - name: Event Information
        run: |
          echo "Event '${{ github.event.action }}' received from '${{ github.event.client_payload.repository }}'"
      - name: Extract branch name
        shell: bash
        run: echo "##[set-output name=branch;]$(echo ${GITHUB_REF#refs/heads/})"
        id: extract_branch
      - name: Print branch name
        shell: bash
        run: echo "${GITHUB_REF}"
      - name: Print branch name 2
        uses: nelonoel/branch-name@v1
        # Use branch name for whatever purpose
        run: echo ${BRANCH_NAME}
      # - name: Trigger Deploy - Dispatch initiating repository event for infrastructure repo to trigger a deployment
      #   if: github.event.action != 'deploy_successful'
      #   run: |
      #     curl -X POST https://api.github.com/repos/DigitalCareerInstitute/infrastructure/dispatches \
      #     -H 'Accept: application/vnd.github.everest-preview+json' \
      #     -u ${{ secrets.ACCESS_TOKEN }} \
      #     --data '{"event_type": "trigger_deploy", "client_payload": { "repository": "'"$GITHUB_REPOSITORY"'" }}'
      # - name: ACK - Acknowledge deploy_successful from remote infrastructure repository
      #   if: github.event.action == 'deploy_successful'
      #   run: |
      #      echo "Done"
